<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Signal LOC reçu par l’avion &mdash; BE ILS</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Taritement du signal LOC reçu par l’avion" href="traitement_loc.html" />
    <link rel="prev" title="Principe de fonctionnement" href="fonctionnement.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            BE Instrument landibng system (ILS)
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Leçons</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="presentation.html">Présentation du BE “Instrument Landing System” (ILS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="fonctionnement.html">Principe de fonctionnement</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Signal LOC reçu par l’avion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#signal-en-bande-de-base">Signal en bande de base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modulation-damplitude">Modulation d’amplitude</a></li>
<li class="toctree-l2"><a class="reference internal" href="#signal-recu-par-lavion">Signal reçu par l’avion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ajout-dun-bruit-gaussien-avec-un-snr-fixe">Ajout d’un bruit gaussien avec un SNR fixé</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="traitement_loc.html">Taritement du signal LOC reçu par l’avion</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Ressources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Ressources/ressources.html">Ressources</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">A propos de</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../About/about.html">A propos de …</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">BE Instrument landibng system (ILS)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Signal LOC reçu par l’avion</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/Cours/signal_LOC.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="signal-loc-recu-par-lavion">
<h1>Signal LOC reçu par l’avion<a class="headerlink" href="#signal-loc-recu-par-lavion" title="Permalink to this heading"></a></h1>
<p>Franck Daout</p>
<p>septembre 2023</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pylab</span> 
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Using matplotlib backend: &lt;object object at 0x7fb97b7172f0&gt;
%pylab is deprecated, use %matplotlib inline and import the required libraries.
Populating the interactive namespace from numpy and matplotlib
</pre></div>
</div>
</div>
</div>
<div class="note admonition">
<p class="admonition-title">Objectifs de cette page</p>
<p>Dans cette partie, nous allons simuler le signal “localizer” reçu par l’avion (dans la suite nous l’appellerons signal LOC). Pour cela nous allons:</p>
<ol class="arabic simple">
<li><p>“Fabriquer” le signal en bande de base reçu par l’avion</p></li>
<li><p>Moduler ce signal (modulation d’amplitude et transposition autour de la fréquence RF)</p></li>
<li><p>Simuler l’effet du canal de propagation</p></li>
</ol>
</div>
<section id="signal-en-bande-de-base">
<h2>Signal en bande de base<a class="headerlink" href="#signal-en-bande-de-base" title="Permalink to this heading"></a></h2>
<p>Le signal reçu par l’avion correspond à une somme pondérée des signaux RF modulés à 90Hz (<span class="math notranslate nohighlight">\(V_{RF90}\)</span>) et 150Hz (<span class="math notranslate nohighlight">\(V_{RF150}\)</span>) :</p>
<div class="math notranslate nohighlight">
\[
V_{RF} = (1 - \alpha)V_{RF150} + \alpha V_{RF90}
\]</div>
<p>La valeur de <span class="math notranslate nohighlight">\(\alpha\)</span> permet de sélectionner le décalage de l’avion par rapport à la piste. Si <span class="math notranslate nohighlight">\(\alpha=0.5\)</span> l’avion est aligné sur l’axe de la piste, si <span class="math notranslate nohighlight">\(\alpha&lt;0.5\)</span> l’avion est à gauche de la piste, le pilote devra corriger en orientant l’avion vers la droite pour le recentrer. Dans le cas où l’avion est à droite de la piste, la valeur de <span class="math notranslate nohighlight">\(\alpha&gt;0.5\)</span></p>
<p>Le signal <span class="math notranslate nohighlight">\(V_{RF}\)</span> s’exprime en fonction des signaux modulant <span class="math notranslate nohighlight">\(V_{90}\)</span> et <span class="math notranslate nohighlight">\(V_{150}\)</span> :</p>
<div class="math notranslate nohighlight">
\[
V_{RF} = (1 - \alpha) A_{RF}(1 + m V_{150})\cos(2 \pi f_c t) + \alpha A_{RF}(1 + m V_{90})\cos(2 \pi f_c t)
\]</div>
<p>avec <span class="math notranslate nohighlight">\(A_{RF}\)</span> l’amplitude de la porteuse, <span class="math notranslate nohighlight">\(m\)</span> le taux de modulation et <span class="math notranslate nohighlight">\(f_c\)</span> la fréquence de la porteuse.</p>
<p>L’expression de <span class="math notranslate nohighlight">\(V_{RF}\)</span> peut se mettre sous la forme :</p>
<div class="math notranslate nohighlight">
\[
V_{RF} = A_{RF}(1 + m V_{base})\cos(2 \pi f_c t)
\]</div>
<p>avec</p>
<div class="math notranslate nohighlight">
\[
V_{base} = \alpha V_{90} + (1 - \alpha) V_{150}
\]</div>
<p><span class="math notranslate nohighlight">\(V_{base}\)</span> est le signal en bande de base (i.e. le modulant) que nous allons fabriquer. Pour cela deux générateurs d’onde CW sont créés. Le premier générateur à une fréquence de 90Hz (<span class="math notranslate nohighlight">\(f_1=90\)</span> Hz) et une amplitude de 1V (<span class="math notranslate nohighlight">\(V_{90}(t)= 1 \cos(2\pi f_1t)\)</span>). Le second génère une onde de fréquence 150Hz (<span class="math notranslate nohighlight">\(f_2=150\)</span> Hz) et d’amplitude de 1V (<span class="math notranslate nohighlight">\(V_{150}(t)= 1 \cos(2\pi f_2t)\)</span>).</p>
<p>Le programme ci-dessous permet de générer le signal LOC en bande de base (<span class="math notranslate nohighlight">\(V_{base}\)</span>) pour différentes valeurs de <span class="math notranslate nohighlight">\(\alpha\)</span> :</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha=0.25\)</span>, ce cas correspond à un avion à gauche de la piste</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha=0.5\)</span>, l’avion est centré (i.e. dans l’axe de la piste)</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha=0;8\)</span>, ce cas correspond à un décalage à droite</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># baseband loc signal generation</span>
<span class="c1">#--------------------------------</span>

<span class="c1">#paramaters</span>

<span class="c1"># Carrier frequency</span>
<span class="n">fc</span> <span class="o">=</span> <span class="mf">10e3</span>
<span class="n">sample_rate</span> <span class="o">=</span> <span class="n">fc</span> <span class="o">*</span> <span class="mf">10.0</span>

<span class="n">f150</span> <span class="o">=</span> <span class="mf">150.0</span><span class="p">;</span> <span class="n">A150</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">f90</span> <span class="o">=</span> <span class="mf">90.0</span><span class="p">;</span> <span class="n">A90</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="c1">#aircraft offset</span>
<span class="n">alpha_range</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>

<span class="c1">#time</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="n">sample_rate</span><span class="p">)</span>

<span class="c1">#sources</span>
<span class="n">V150</span> <span class="o">=</span> <span class="n">A150</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">f150</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">V90</span> <span class="o">=</span> <span class="n">A90</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">f90</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha_range</span><span class="p">):</span> 
    <span class="c1">#resistive mixer</span>
    <span class="n">Vbase</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">V150</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">V90</span>
    
    <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Vbase</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;alpha =&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
    
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Vbase (V)&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">grid</span><span class="p">()</span>
<span class="n">title</span><span class="p">(</span><span class="s2">&quot;Baseband LOC signal&quot;</span><span class="p">)</span>

<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ac8c0c0c81b11b21a8f6a705795699c79c7369a74e528a4eb2788eff7f605d49.png" src="../_images/ac8c0c0c81b11b21a8f6a705795699c79c7369a74e528a4eb2788eff7f605d49.png" />
</div>
</div>
<p>Nous allons maintenant étudier le cas où l’avion est dans l’axe de la piste. Dans ce cas <span class="math notranslate nohighlight">\(\alpha=0.5\)</span>, le programme et la figure ci-dessous présentent le comportement temporel de <span class="math notranslate nohighlight">\(V_{base}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#aircraft offcet</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1">#resistive mixer</span>
<span class="n">Vbase</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">V150</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">V90</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> 
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Vbase</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;alpha =&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>  
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Vbase (V)&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">grid</span><span class="p">()</span>
<span class="n">title</span><span class="p">(</span><span class="s2">&quot;Baseband LOC signal for alpha = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>

<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0a8ecc22974f4362d3069074bbd37d62497067536f7603e10182ffb2a05b42bc.png" src="../_images/0a8ecc22974f4362d3069074bbd37d62497067536f7603e10182ffb2a05b42bc.png" />
</div>
</div>
<p>Le spectre unilatéral d’amplitude du signal en bande de base est présenté sur la figure ci-dessous. Il est constitué de deux raies. La première raie correspond au signal “90Hz” et la seconde au signal “150Hz”. Ces deux raies ont une amplitude identique, car l’avion est dans l’axe de la piste (i.e. <span class="math notranslate nohighlight">\(\alpha=0.5\)</span>). L’analyse du signal en réception consistera donc à comparer l’amplitude de ces deux raies pour en déduire la position de l’avion.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#spectral analysis</span>

<span class="n">Sbase</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">Vbase</span><span class="p">)</span>
<span class="n">Sbase</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Sbase</span><span class="p">)</span>
<span class="n">freq</span> <span class="o">=</span> <span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Vbase</span><span class="p">),</span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sample_rate</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">stem</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Sbase</span><span class="p">))</span>
<span class="n">grid</span><span class="p">()</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (Hz)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;magnitude (V)&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Baseband LOC spectrum for alpha = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
      
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1792f9052eff43c1519691778e64258fbbef043802b0dde82924fe24065802e9.png" src="../_images/1792f9052eff43c1519691778e64258fbbef043802b0dde82924fe24065802e9.png" />
</div>
</div>
</section>
<section id="modulation-damplitude">
<h2>Modulation d’amplitude<a class="headerlink" href="#modulation-damplitude" title="Permalink to this heading"></a></h2>
<p>Le signal en bande de base est ensuite modulé en amplitude autour de la fréquence de la porteuse <span class="math notranslate nohighlight">\(f_c\)</span>. Le taux de modulation est de 40% :</p>
<div class="math notranslate nohighlight">
\[
V_{RF} = A_{RF}(1 + 0.4 V_{base})\cos(2 \pi f_c t)
\]</div>
<p>ou <span class="math notranslate nohighlight">\(A_{RF}\)</span> est l’amplitude de la porteuse, dans notre cas 1V.</p>
<p>Pour des raisons de simulation, dans ce travail le signal est échantillonné à 100KHz avec <span class="math notranslate nohighlight">\(f_c\)</span>= 10KHz.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Notons que la fréquence de la porteuse ne correspond pas à la valeur utilisée dans le domaine aéronautique (i.e. entre 108.1 et 111.95 MHz). Il s’agit d’une simplification permettant d’économiser nos ressources de calcul.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># RF signal</span>

<span class="c1">#parameters</span>

<span class="c1">#modulation depth</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.4</span>

<span class="n">Arf</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1">#set the RF signal (Amplitude Modulation)</span>
<span class="n">Vrf</span> <span class="o">=</span> <span class="n">Arf</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">Vbase</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">fc</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Vrf</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;magnitude (V)&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;RF signal for alpha = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f8fb9cd94f7b1b03e1bf59ba9373e29a9978aede9328b4259085b60fe9fb7658.png" src="../_images/f8fb9cd94f7b1b03e1bf59ba9373e29a9978aede9328b4259085b60fe9fb7658.png" />
</div>
</div>
<p>Le spectre d’amplitude unilatéral est présenté sur la figure suivante.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#spectral analysis</span>

<span class="n">Srf</span> <span class="o">=</span> <span class="n">rfft</span><span class="p">(</span><span class="n">Vrf</span><span class="p">)</span>
<span class="n">Srf</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Srf</span><span class="p">)</span> 
<span class="n">Vfreq</span> <span class="o">=</span> <span class="n">rfftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Vrf</span><span class="p">),</span><span class="n">d</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">sample_rate</span><span class="p">)</span>
<span class="n">mar150</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">m</span><span class="o">/</span><span class="mi">2</span>
<span class="n">mar90</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">m</span><span class="o">/</span><span class="mi">2</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">stem</span><span class="p">(</span><span class="n">freq</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Srf</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="n">mar90</span><span class="o">*</span><span class="n">ones_like</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Srf</span><span class="p">)),</span><span class="s1">&#39;--r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;V = </span><span class="si">{0:3.2f}</span><span class="s2">V&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mar90</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="n">mar150</span><span class="o">*</span><span class="n">ones_like</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Srf</span><span class="p">)),</span><span class="s1">&#39;--m&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;V = </span><span class="si">{0:3.2f}</span><span class="s2">V&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mar150</span><span class="p">))</span>
<span class="n">legend</span><span class="p">()</span>
<span class="n">grid</span><span class="p">()</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">10</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">10</span><span class="o">+</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39; frequency (KHz)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;magnitude (V)&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;RF LOC spectrum for alpha = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
      
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fc0c74e313f3ad5b004015feb29148953f612ef4a299b611de3515befb0b941e.png" src="../_images/fc0c74e313f3ad5b004015feb29148953f612ef4a299b611de3515befb0b941e.png" />
</div>
</div>
<p>Le spectre du signal RF présente une raie principale à la fréquence de la porteuse (dans notre cas <span class="math notranslate nohighlight">\(f_c\)</span>=10 KHz) et de part et d’autre de cette fréquence, le spectre du signal en bande de base constitué de deux raies dont l’amplitude est liée à la position de l’avion (i.e. <span class="math notranslate nohighlight">\(\alpha\)</span>) mais aussi au taux de modulation.</p>
<p>Pour cet exemple, comme l’avion est centré (<span class="math notranslate nohighlight">\(\alpha=0.5\)</span>), l’amplitude des raies “90Hz” et “150Hz” est identique.</p>
<p>Il convient de s’arrêter sur la nécessité de moduler puisque l’information de la position de l’avion est déjà “portée” par le signal en bande de base.</p>
<div class="dropdown admonition tip">
<p class="admonition-title">Tip</p>
<p>Pourquoi moduler ! 💬</p>
<p>La modulation RF permet de transposer le signal en bande de base autour de la fréquence de la porteuse. Il s’agit donc de “déplacer”, le signal informatif vers une fréquence plus élevée. On peut s’interroger sur la nécessité de réaliser cette transposition fréquentielle ?</p>
<p>IL existe plusieurs réponses à cette question :</p>
<ul class="simple">
<li><p>La dimension des antennes est liée à la fréquence transmise (plus exactement à la longueur d’onde <span class="math notranslate nohighlight">\(\lambda\)</span> qui est définie par <span class="math notranslate nohighlight">\(\lambda = c/f\)</span> avec <span class="math notranslate nohighlight">\(c=3e8\)</span>m/s et <span class="math notranslate nohighlight">\(f\)</span> la fréquence du signal en Hz). Dans notre cas la fréquence du signal en bande de base est voisin de 120Hz, ce qui entraîne une longueur d’onde de 2500Km !, il faudrait donc avoir des antennes dont les dimensions sont proches de cette valeur !. Le fait de transposer le signal de 90Hz où 150Hz autour de 110MHz entraine des dimensions d’antenne dans le domaine métrique. Ainsi le fait d’augmenter la fréquence permet de réduire la taille des antennes mais aussi leurs encombrements et leurs poids. Toutefois le fait d’augmenter la fréquence présente aussi des inconvénients notamment sur les conditions de propagation: les pertes de propagations sont inversement proportionnelles au carré de la fréquence. De plus les ondes ont plus de difficultés à se propager à travers des interfaces telle que des murs lorsque la fréquence augmente.</p></li>
<li><p>Le bruit de fond notamment celui provenant des activités humaines est plus important en basse fréquence. De ce fait pour pouvoir détecter le signal, il faudra l’émettre avec plus de puissance en basse fréquence.</p></li>
</ul>
<p>Voici donc les deux principaux arguments pour utiliser une fréquence RF pour transmettre une information.</p>
</div>
</section>
<section id="signal-recu-par-lavion">
<h2>Signal reçu par l’avion<a class="headerlink" href="#signal-recu-par-lavion" title="Permalink to this heading"></a></h2>
<p>Dans une première approximation, on considère que le signal reçu par l’avion <span class="math notranslate nohighlight">\(Vr_{RF}\)</span> correspond au signal transmis <span class="math notranslate nohighlight">\(V_{RF}\)</span> retardé et atténué :</p>
<div class="math notranslate nohighlight">
\[
Vr_{RF}(t) = \beta V_{RF}(t-t_d)
\]</div>
<p>avec <span class="math notranslate nohighlight">\(\beta\)</span> l’atténuation du signal (<span class="math notranslate nohighlight">\(0&lt;\beta &lt; 1\)</span>) et <span class="math notranslate nohighlight">\(t_d\)</span> le temps de propagation du signal.</p>
<p>La figure ci_dessous présente le signal reçu lorsque l’avion est à une distance de <span class="math notranslate nohighlight">\(R=\)</span>3000m de l’émetteur du “localiser”. Pour des raisons de simplification, on suppose que le signal n’est pas atténué (<span class="math notranslate nohighlight">\(\beta=1\)</span>). Le temps de propagation <span class="math notranslate nohighlight">\(t_d\)</span> s’exprime simplement à partir de :</p>
<div class="math notranslate nohighlight">
\[
t_d = \frac{R}{c}
\]</div>
<p>avec <span class="math notranslate nohighlight">\(c=\)</span> 3e8m/s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># LOC signal received by aircraft</span>

<span class="k">def</span> <span class="nf">Vrf</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">alpha</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LOC signal calculation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A90</span> <span class="o">=</span><span class="mf">1.0</span>
    <span class="n">A150</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">f90</span> <span class="o">=</span> <span class="mf">90.0</span>
    <span class="n">f150</span> <span class="o">=</span> <span class="mf">150.0</span>
    <span class="n">Arf</span> <span class="o">=</span><span class="mf">1.0</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="mf">10e3</span>
    
    <span class="n">V150</span> <span class="o">=</span> <span class="n">A150</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">f150</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">V90</span> <span class="o">=</span> <span class="n">A90</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">f90</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">Vbase</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">V150</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">V90</span>
    <span class="n">Vrf</span> <span class="o">=</span> <span class="n">Arf</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">m</span><span class="o">*</span><span class="n">Vbase</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">fc</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Vrf</span>
    
<span class="n">distance</span> <span class="o">=</span> <span class="mf">3000.0</span>
<span class="n">tp</span> <span class="o">=</span> <span class="n">distance</span> <span class="o">/</span> <span class="mf">3e8</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;temps de propagation : </span><span class="si">{</span><span class="n">tp</span><span class="o">/</span><span class="mf">1e-6</span><span class="si">:</span><span class="s2">3.2f</span><span class="si">}</span><span class="s2">us&quot;</span><span class="p">)</span>

<span class="n">Vr_rf</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="n">Vrf</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">tp</span><span class="p">,</span><span class="n">alpha</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Vr_rf</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;magnitude (V)&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;RF signal after propagation for alpha = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>temps de propagation : 10.00us
</pre></div>
</div>
<img alt="../_images/6ff786c1e847dd6aae68e570a1bfaa03e2a1db3691a1e866c2d04a5399d35aa8.png" src="../_images/6ff786c1e847dd6aae68e570a1bfaa03e2a1db3691a1e866c2d04a5399d35aa8.png" />
</div>
</div>
<section id="ajout-dun-bruit-gaussien-avec-un-snr-fixe">
<h3>Ajout d’un bruit gaussien avec un SNR fixé<a class="headerlink" href="#ajout-dun-bruit-gaussien-avec-un-snr-fixe" title="Permalink to this heading"></a></h3>
<p>L’avion reçoit le signal atténué et retardé additionné d’un bruit (<span class="math notranslate nohighlight">\(b(t)\)</span>) qui provient de l’environnement :</p>
<div class="math notranslate nohighlight">
\[
Vr_{RF}(t) = \beta V_{RF}(t-t_d) + b(t)
\]</div>
<p>Classiquement la puissance du bruit s’exprime en fonction de la puissance du signal en utilisant la définition du <a class="reference external" href="https://fr.wikipedia.org/wiki/Rapport_signal_sur_bruit">rapport signal sur bruit</a> (SNR: Signal Noise Ratio) :</p>
<div class="math notranslate nohighlight">
\[
SNR_{dB}=10\log(\frac{P_{signal}}{P_{bruit}})
\]</div>
<p>Dans cette équation, le SNR est exprimé en dB. <span class="math notranslate nohighlight">\(P_{signal}\)</span> est la puissance du signal exprimée en W et <span class="math notranslate nohighlight">\(P_{bruit}\)</span>, la puissance du bruit en W.</p>
<p>Dans notre exemple, nous considérons un SNR de 20dB.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add noise </span>

<span class="k">def</span> <span class="nf">add_noise</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">SNR</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;    </span>
<span class="sd">    Compute d = s + n such that SNR = Ps/Pn</span>
<span class="sd">    s: Input signal</span>
<span class="sd">    SNR: Desired signal-to-noise ratio</span>
<span class="sd">    d: Output signal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
    <span class="n">Es</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">s</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">En</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Es</span><span class="o">/</span><span class="p">(</span><span class="n">SNR</span><span class="o">*</span><span class="n">En</span><span class="p">))</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">s</span><span class="o">+</span><span class="n">alpha</span><span class="o">*</span><span class="n">n</span>
    <span class="k">return</span> <span class="n">d</span>

<span class="c1">#SNR in dB</span>
<span class="n">SNR</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">snr</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">SNR</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Vr_rfb</span> <span class="o">=</span> <span class="n">add_noise</span><span class="p">(</span><span class="n">Vr_rf</span><span class="p">,</span><span class="n">snr</span><span class="p">)</span> 

<span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">Vr_rfb</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="p">()</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;magnitude (V)&#39;</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;RF signal after propagation with noise for alpha = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
<span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/45befbf66a32d49300a3a02ea14a44ab546114401df7a923e09f180e7f14d7f2.png" src="../_images/45befbf66a32d49300a3a02ea14a44ab546114401df7a923e09f180e7f14d7f2.png" />
</div>
</div>
<p>Finalement nous sauvegardons le signal reçu par l’avion dans un fichier texte pour pouvoir le réutiliser lors de la prochaine leçon.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#save the LOC data</span>

<span class="c1">#parameter</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;../_static/data/loc_data.txt&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Vr_rfb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Synthèse</p>
<p>Dans cette page nous avons vu comment simuler le signal reçu par l’avion en fonction de sa position par rapport à l’axe de la piste. Pour cela nous avons “fabriqué” le signal en bande de base, puis nous l’avons transposé autour de la fréquence de la porteuse en utilisant une modulation d’amplitude. Le canal de propagation a été ensuite simulé et enfin un bruit gaussien à été ajouté.</p>
<p>Dans la suite nous allons chercher à traiter le signal reçu par l’avion pour en déduire une information de position.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fonctionnement.html" class="btn btn-neutral float-left" title="Principe de fonctionnement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="traitement_loc.html" class="btn btn-neutral float-right" title="Taritement du signal LOC reçu par l’avion" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Franck Daout.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>